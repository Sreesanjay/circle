import{i as u,Q as l,r as c,j as e}from"./index-m-eWRAVj.js";import{A as _}from"./AdminSidebar-aX9fpIq8.js";import{B as y,T as t,P as b}from"./Toast-KVdhVArs.js";import{F as T,N as R,V as E}from"./ViewReports-oN5U2HAR.js";import"./Menu-ML_fOrjv.js";import"./index.esm-XQb_oNS5.js";import"./index.esm-5AkatTaU.js";async function S(){var n;try{return(await u.get("/admin/discussion-management/analytics")).data}catch(r){const a=r;a.response?l.error((n=a.response)==null?void 0:n.data.message):l.error(a.message)}}async function D(n,r){var a;try{return(await u.get(`/admin/discussion-management?page=${n}&&sort=${r}`)).data}catch(i){const o=i;o.response?l.error((a=o.response)==null?void 0:a.data.message):l.error(o.message)}}async function P(n){var r;try{return(await u.delete(`/admin/discussion-management/remove/${n}`)).data}catch(a){const i=a;i.response?l.error((r=i.response)==null?void 0:r.data.message):l.error(i.message)}}async function k(n){var r;try{return(await u.put(`/admin/discussion-management/undo-remove/${n}`)).data}catch(a){const i=a;i.response?l.error((r=i.response)==null?void 0:r.data.message):l.error(i.message)}}function V(){const[n,r]=c.useState({total_discussion:0,todays_discussion:0,thismonth_discussion:0,this_year_discussion:0}),[a,i]=c.useState("RECENTLTY_CREATED"),[o,f]=c.useState(1),[x,p]=c.useState([]),[g,N]=c.useState(null),[C,j]=c.useState(!1);c.useEffect(()=>{(async()=>{const s=await S();s.analytics&&r(s.analytics)})()},[]),c.useEffect(()=>{(async()=>{const s=await D(o,a);s.discussionList&&p(s.discussionList)})()},[o,a]);async function v(s){(await P(s)).deletedDiscussion&&(l.success("discussion removed"),p(m=>m.map(d=>(d._id===s&&(d.is_delete=!0),d))))}async function w(s){(await k(s)).discussion&&(l.success("discussion recovered"),p(m=>m.map(d=>(d._id===s&&(d.is_delete=!1),d))))}return e.jsxs("div",{children:[e.jsxs("div",{className:"community-management",children:[e.jsx(_,{}),e.jsxs("section",{className:"body md:ms-80 py-5",children:[e.jsx(y,{"aria-label":"Default breadcrumb example",children:e.jsx(y.Item,{href:"#",children:"Post Management"})}),e.jsxs("section",{className:"analytics flex justify-around gap-2 flex-wrap mt-5",children:[e.jsxs("div",{className:"analytics-card ",children:[e.jsx("h1",{children:"Total Communities"}),e.jsx("h1",{className:"text-4xl",children:n.total_discussion})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community(Today)"}),e.jsx("h1",{className:"text-4xl",children:n.todays_discussion})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community(This Month)"}),e.jsx("h1",{className:"text-4xl",children:n.thismonth_discussion})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community (This Year)"}),e.jsx("h1",{className:"text-4xl",children:n.this_year_discussion})]})]}),e.jsxs("section",{className:"filter flex items-center justify-between my-5 px-5",children:[e.jsx("div",{className:"sort",children:e.jsxs(T,{fullWidth:!0,children:[e.jsx("label",{htmlFor:"uncontrolled-native",children:"Sort"}),e.jsxs(R,{defaultValue:a,inputProps:{name:"sort",id:"uncontrolled-native"},onChange:s=>i(s.target.value),children:[e.jsx("option",{value:"RECENTLTY_CREATED",children:"Recently Created"}),e.jsx("option",{value:"OLDEST_COMMUNITY",children:"Oldest Posts"}),e.jsx("option",{value:"REPORTS",children:"Reports"})]})]})}),e.jsx("div",{className:"search",children:e.jsx("input",{type:"text",placeholder:"Search Communities",className:"rounded-md text-black"})})]}),e.jsxs("section",{className:"community-list py-5 pe-5 overflow-x-scroll",children:[e.jsxs(t,{hoverable:!0,children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Si. No"}),e.jsx(t.HeadCell,{children:"Discussion"}),e.jsx(t.HeadCell,{children:"username"}),e.jsx(t.HeadCell,{children:"Likes"}),e.jsx(t.HeadCell,{children:"Reports"}),e.jsx(t.HeadCell,{children:e.jsx("span",{className:"sr-only",children:"Block"})})]}),e.jsx(t.Body,{className:"divide-y",children:x==null?void 0:x.map((s,h)=>{var m;return e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"whitespace-nowrap font-medium text-gray-900 dark:text-white",children:h}),e.jsx(t.Cell,{children:s.content_type==="TEXT"?e.jsx("p",{className:"max-w-80 text-wrap",children:s.content}):e.jsx("img",{src:s.content,className:"w-10 h-10",alt:""})}),e.jsx(t.Cell,{children:s.userProfile.username}),e.jsx(t.Cell,{children:s.likes.length}),e.jsx(t.Cell,{children:e.jsx("button",{onClick:()=>{N(s._id),j(!0)},children:"View"})}),e.jsx(t.Cell,{children:(m=s.reports)==null?void 0:m.length}),e.jsx(t.Cell,{children:s.is_delete?e.jsx("button",{onClick:()=>w(s._id),children:"Undo"}):e.jsx("button",{onClick:()=>v(s._id),className:"text-red-600",children:"Delete"})})]},h)})})]}),e.jsx("div",{className:"pagination mt-5",children:e.jsx(b,{currentPage:o,totalPages:Math.ceil(n.total_discussion/10),onPageChange:s=>f(s)})})]})]})]}),e.jsx(E,{reportedId:g,openModal:C,setOpenModal:j})]})}export{V as default};
