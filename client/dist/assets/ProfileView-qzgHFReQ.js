import{r as l,F as O,i as c,Q as i,j as e,T as U}from"./index-tALA5zrJ.js";import{L as d}from"./Toast-R09rX9KI.js";import{R as $}from"./Report-xLLjgZIq.js";import{P as D}from"./PostModal-yuqBBzL7.js";import{I as T,a as z}from"./ImageListItem-YNEUrpuJ.js";import"./index.esm-gWB3LAAE.js";import"./index.esm-gSwdpNek.js";import"./usehandleError-7JD95pas.js";import"./Badge-oH0ryGbn.js";import"./Typography-VDQaoRQy.js";import"./extendSxProp-MeG5tTPz.js";function Z({socket:n}){const[a,b]=l.useState(),[h,x]=l.useState(!1),[C,k]=l.useState(0),[I,m]=l.useState(0),[f,p]=l.useState(!1),[j,u]=l.useState(!1),[S,w]=l.useState(!1),[F,g]=l.useState(!1),[y,_]=l.useState(null),{id:o}=O(),[N,B]=l.useState([]);function L(s){g(!0),_(s)}l.useEffect(()=>{(async()=>{var s;try{const t=await c.get(`/profile/get-posts/${o}`,{withCredentials:!0});t.data&&(console.log(t.data.posts),B(t.data.posts))}catch(t){const r=t;i.error((s=r.response)==null?void 0:s.data.message)}})()},[o]),l.useEffect(()=>{(async()=>{var s;try{const t=await c.get(`/users/get-user-profile/${o}`,{withCredentials:!0});t.data&&(b(t.data.userProfile),k(t.data.following),m(t.data.followers),p(t.data.isFollowing),u(t.data.isBlocked))}catch(t){const r=t;i.error((s=r.response)==null?void 0:s.data.message)}})()},[o]);async function M(){try{(await c.post("/users/unfollow",{id:o},{withCredentials:!0})).data&&(p(!1),m(t=>t-1))}catch(s){const t=s;i.error(t.message)}}async function R(){try{(await c.post("/users",{id:o},{withCredentials:!0})).data&&(m(t=>t+1),p(!0))}catch(s){const t=s;i.error(t.message)}}async function E(){var s;try{(await c.get(`/users/block-user/${o}`,{withCredentials:!0})).data&&((s=n==null?void 0:n.current)==null||s.emit("block-user",o),p(!1),f&&m(r=>r-1),u(!0))}catch(t){const r=t;i.error(r.message)}}async function v(){var s;try{(await c.get(`/users/unblock-user/${o}`,{withCredentials:!0})).data&&(u(!1),(s=n==null?void 0:n.current)==null||s.emit("unblock-user",o))}catch(t){const r=t;i.error(r.message)}}return e.jsxs("section",{className:"profile-view",children:[e.jsx($,{openModal:S,setOpenModal:w,id:o,reported_type:"account"}),e.jsx("section",{className:"cover-photo",children:a!=null&&a.cover_img?e.jsx("img",{src:a==null?void 0:a.cover_img,className:"object-cover w-screen max-h-64"}):e.jsx("div",{className:"default-cover",children:e.jsx("img",{src:"https://images.fastcompany.net/image/upload/w_596,c_limit,q_auto:best,f_auto/wp-cms/uploads/2021/03/LinkedIn-Default-Background-2020-.jpg",alt:"",className:"w-full max-h-64"})})}),e.jsxs("section",{className:"profile-details grid grid-cols-12 min-h-96",children:[e.jsxs("section",{className:"left-section col-span-3 shadow-md flex flex-col items-center p-5",children:[e.jsx("div",{className:"profile-image w-36 flex justify-center",children:a!=null&&a.profile_img?e.jsx("img",{src:a==null?void 0:a.profile_img,alt:"",className:"w-28 shadow-lg rounded-full"}):e.jsx("img",{src:"https://static.vecteezy.com/system/resources/thumbnails/010/260/479/small/default-avatar-profile-icon-of-social-media-user-in-clipart-style-vector.jpg",alt:"",className:"w-full rounded-md"})}),e.jsxs("div",{className:"profile-info py-5 flex flex-col items-center w-full",children:[e.jsx("h1",{className:"text-2xl",children:a==null?void 0:a.username}),e.jsx("h3",{children:a==null?void 0:a.fullname}),e.jsxs("div",{className:"counts flex justify-around w-full",children:[e.jsxs("div",{className:" flex flex-col items-center",children:[e.jsx("span",{children:C}),e.jsx("h1",{children:"Followig"})]}),e.jsxs("div",{className:" flex flex-col items-center",children:[e.jsx("span",{children:I}),e.jsx("h1",{children:"Followers"})]})]}),e.jsx("div",{className:"btn py-5",children:j?e.jsx("button",{className:"bg-primary py-1 px-7 rounded-md text-white",onClick:()=>v(),children:"UnBlock"}):f?e.jsx("button",{className:"bg-primary py-1 px-7 rounded-md text-white",onClick:()=>M(),children:"Unfollow"}):e.jsx("button",{className:"bg-primary py-1 px-7 rounded-md text-white",onClick:()=>R(),children:"Follow"})}),e.jsx("h1",{className:"mt-8 mb-3",children:"Bio"}),e.jsx("span",{className:"bio",children:a==null?void 0:a.bio})]})]}),e.jsxs("section",{className:"posts-section col-span-9",children:[e.jsxs("header",{className:"w-full flex justify-between p-5 relative",children:[e.jsx("h1",{className:"p-5 text-lg font-medium",children:"Posts"}),e.jsx("div",{className:"",onClick:()=>x(!h),children:e.jsx(U,{size:35})}),h&&e.jsx(d,{className:"w-48 absolute right-5 top-16",onClick:()=>x(!h),children:e.jsxs("div",{className:"shadow-md",children:[j?e.jsx(d.Item,{onClick:()=>v(),children:"UnBlock"}):e.jsx(d.Item,{onClick:()=>E(),children:"Block"}),e.jsx(d.Item,{onClick:()=>w(!0),children:"Report"}),e.jsx(d.Item,{children:"Messages"}),e.jsx(d.Item,{children:"Download"})]})})]}),e.jsx("div",{className:"body",children:e.jsx(T,{style:{overflow:"hidden",height:"100%"},className:"image-list",variant:"masonry",cols:3,gap:1,children:N&&N.map(s=>e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"",children:e.jsx("div",{className:"content p-2 shadow-md",onClick:()=>L(s),children:s.type.includes("image")?e.jsx("img",{src:s==null?void 0:s.content,className:"w-full rounded-md"}):e.jsx("div",{className:"relative",children:e.jsxs("video",{className:"w-full",muted:!0,children:[e.jsx("source",{src:s==null?void 0:s.content,type:"video/mp4"}),"Error Message"]})})})},s._id),y&&e.jsx(D,{openModal:F,setOpenModal:g,type:"OTHERS",post:y})]}))})})]})]})]})}export{Z as default};
