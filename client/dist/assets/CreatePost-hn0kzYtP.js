import{a as k,u as N,m as H,r as a,i as M,Q as l,ai as C,j as e,L as O,aj as V}from"./index-m-eWRAVj.js";import{B as y,b as z,F as D}from"./Toast-KVdhVArs.js";import{b as W}from"./index.esm-XQb_oNS5.js";import{H as _}from"./HomeSidebar-ovSdexXJ.js";import{u as Q}from"./usehandleError-m2VEsqkY.js";import{I as T}from"./ImageCrop-WxXaXkfb.js";import{B as q}from"./Badge-w0IGsy5p.js";import"./index.esm-5AkatTaU.js";import"./index.esm-IW_VCk-f.js";import"./Menu-ML_fOrjv.js";import"./index.esm-mYd38-lK.js";function re(){const i=k(),{isLoading:I,isSuccess:c,isError:d,errorMessage:m}=N(s=>s.post),p=H(),[o,u]=a.useState([]),S=Q(),{userProfile:w}=N(s=>s.user),[f,x]=a.useState([]),[E,F]=a.useState(""),[r,g]=a.useState(),[h,L]=a.useState("public"),[B,j]=a.useState(""),[P,b]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const s=await M.get("/manage-account/interest",{withCredentials:!0});s.data&&(u(s.data.interest),u(s.data.interest))}catch(s){const t=s;t&&S(t)}})()},[w]);function R(s){if(s.target.files){if(s.target.files[0].size>5*1024*1024&&l.error("maximum file size is 5MB"),s.target.files[0].type.startsWith("image/"))j(URL.createObjectURL(s.target.files[0])),b(!0);else if(s.target.files[0].type.startsWith("video/")){const t=new Blob([s.target.files[0]],{type:s.target.files[0].type});g(t)}}}a.useEffect(()=>{j("")},[r]);function U(){r?i(V({content:r,visibility:h,caption:E,tags:f})):l("error")}return a.useEffect(()=>{c&&(l("New post created"),i(C()),p("/")),d&&(l.error(m),i(C()))},[c,d,m,i,p]),e.jsx(e.Fragment,{children:I?e.jsx(O,{}):e.jsxs(e.Fragment,{children:[e.jsx(T,{src:B,aspect:1/1,isCrop:P,setisCrop:b,setImage:g}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(_,{}),e.jsxs("section",{className:"create-post md:ms-80 p-5",children:[e.jsx(y,{"aria-label":"Default breadcrumb example",children:e.jsx(y.Item,{icon:W,children:"Create Post"})}),e.jsx("h1",{className:"text-2xl font-medium mb-5",children:"Create new Post"}),e.jsxs("div",{className:"body grid grid-cols-4 ",children:[e.jsxs("div",{className:"preview-section col-span-4 lg:col-span-2",children:[e.jsxs("div",{className:"mb-2 block pe-10 text-white",children:[e.jsx(z,{htmlFor:"file-upload",value:"Upload file"}),e.jsx(D,{id:"file-upload",className:"h-24 ",onChange:R,accept:"image/*|video/*"})]}),e.jsx("img",{src:r?URL.createObjectURL(r):void 0,alt:""})]}),e.jsx("div",{className:"form-section col-span-4 lg:col-span-2",children:e.jsxs("div",{className:"form",children:[e.jsxs("div",{className:"form-control flex flex-col lg:pe-16 mb-4",children:[e.jsx("label",{htmlFor:"",children:"Add Caption"}),e.jsx("textarea",{className:"rounded-md bg-gray-800",onChange:s=>F(s.target.value)})]}),e.jsxs("div",{className:"form-control flex flex-col lg:pe-16 mb-3",children:[e.jsx("label",{htmlFor:"",children:"Visibility"}),e.jsx("select",{name:"",id:"",className:"rounded-md bg-gray-800",defaultValue:h,onChange:s=>L(s.target.value),children:e.jsx("option",{value:"public",children:"Public"})})]}),e.jsxs("div",{className:"form-control flex flex-col lg:pe-16",children:[e.jsx("label",{htmlFor:"",children:"Tags"}),e.jsx("div",{className:"selected-tags flex gap-5 my-5 flex-wrap",children:f.map((s,t)=>{const v=o.find(n=>n._id===s);return e.jsx(q,{badgeContent:e.jsx("button",{onClick:()=>x(n=>n.filter(A=>A!==s)),children:"-"}),color:"success",children:v&&v.interest},t)})}),e.jsxs("select",{name:"",id:"",className:"rounded-md bg-gray-800",onChange:s=>x(t=>[...t,s.target.value]),children:[e.jsx("option",{value:""}),o&&o.map((s,t)=>e.jsx("option",{value:s._id,children:s.interest},t))]})]}),e.jsx("div",{className:"form-buttons",children:e.jsx("button",{className:"bg-primary hover:bg-primary-hover px-5 py-1 rounded-md text-white mt-5",onClick:U,children:"Upload"})})]})})]})]})]})]})})}export{re as default};
