import{a as D,m as T,r,F as z,i as c,Q as i,j as e,T as q,s as A}from"./index-cfxOLQ6P.js";import{L as d}from"./Toast-PBJrG1i5.js";import{R as G}from"./Report-cZHz2sIU.js";import{P as H}from"./PostModal-TjcDqj1q.js";import{m as Q}from"./chatService-9lIoeBl-.js";import{I as V,a as J}from"./ImageListItem-Z8nGfgOD.js";import"./index.esm-4AC6K3-g.js";import"./index.esm-DdDcHZkO.js";import"./usehandleError-draf_M2d.js";import"./Badge-EdG0-msV.js";import"./Typography-_yUm78aI.js";import"./extendSxProp-epbv63kb.js";function le({socket:n}){const C=D(),b=T(),[a,k]=r.useState(),[h,f]=r.useState(!1),[S,I]=r.useState(0),[F,m]=r.useState(0),[x,p]=r.useState(!1),[g,u]=r.useState(!1),[_,j]=r.useState(!1),[B,w]=r.useState(!1),[y,L]=r.useState(null),{id:o}=z(),[N,M]=r.useState([]);function O(s){w(!0),L(s)}r.useEffect(()=>{(async()=>{var s;try{const t=await c.get(`/profile/get-posts/${o}`,{withCredentials:!0});t.data&&(console.log(t.data.posts),M(t.data.posts))}catch(t){const l=t;i.error((s=l.response)==null?void 0:s.data.message)}})()},[o]),r.useEffect(()=>{(async()=>{var s;try{const t=await c.get(`/users/get-user-profile/${o}`,{withCredentials:!0});t.data&&(k(t.data.userProfile),I(t.data.following),m(t.data.followers),p(t.data.isFollowing),u(t.data.isBlocked))}catch(t){const l=t;i.error((s=l.response)==null?void 0:s.data.message)}})()},[o]);async function R(){try{(await c.post("/users/unfollow",{id:o},{withCredentials:!0})).data&&(p(!1),m(t=>t-1))}catch(s){const t=s;i.error(t.message)}}async function E(){try{(await c.post("/users",{id:o},{withCredentials:!0})).data&&(m(t=>t+1),p(!0))}catch(s){const t=s;i.error(t.message)}}async function U(){var s;try{(await c.get(`/users/block-user/${o}`,{withCredentials:!0})).data&&((s=n==null?void 0:n.current)==null||s.emit("block-user",o),p(!1),x&&m(l=>l-1),u(!0))}catch(t){const l=t;i.error(l.message)}}async function v(){var s;try{(await c.get(`/users/unblock-user/${o}`,{withCredentials:!0})).data&&(u(!1),(s=n==null?void 0:n.current)==null||s.emit("unblock-user",o))}catch(t){const l=t;i.error(l.message)}}async function $(){if(o){const s=await Q(o);C(A(s.chat)),b("/messages")}}return e.jsxs("section",{className:"profile-view",children:[e.jsx(G,{openModal:_,setOpenModal:j,id:o,reported_type:"account"}),e.jsx("section",{className:"cover-photo",children:a!=null&&a.cover_img?e.jsx("img",{src:a==null?void 0:a.cover_img,className:"object-cover w-screen max-h-64"}):e.jsx("div",{className:"default-cover",children:e.jsx("img",{src:"https://images.fastcompany.net/image/upload/w_596,c_limit,q_auto:best,f_auto/wp-cms/uploads/2021/03/LinkedIn-Default-Background-2020-.jpg",alt:"",className:"w-full max-h-64"})})}),e.jsxs("section",{className:"profile-details grid grid-cols-12 min-h-96",children:[e.jsxs("section",{className:"left-section col-span-3 shadow-md flex flex-col items-center p-5",children:[e.jsx("div",{className:"profile-image w-36 flex justify-center",children:a!=null&&a.profile_img?e.jsx("img",{src:a==null?void 0:a.profile_img,alt:"",className:"w-28 shadow-lg rounded-full"}):e.jsx("img",{src:"https://static.vecteezy.com/system/resources/thumbnails/010/260/479/small/default-avatar-profile-icon-of-social-media-user-in-clipart-style-vector.jpg",alt:"",className:"w-full rounded-md"})}),e.jsxs("div",{className:"profile-info py-5 flex flex-col items-center w-full",children:[e.jsx("h1",{className:"text-2xl",children:a==null?void 0:a.username}),e.jsx("h3",{children:a==null?void 0:a.fullname}),e.jsxs("div",{className:"counts flex justify-around w-full",children:[e.jsxs("div",{className:" flex flex-col items-center",children:[e.jsx("span",{children:S}),e.jsx("h1",{children:"Following"})]}),e.jsxs("div",{className:" flex flex-col items-center",children:[e.jsx("span",{children:F}),e.jsx("h1",{children:"Followers"})]})]}),e.jsx("div",{className:"btn py-5",children:g?e.jsx("button",{className:"bg-primary py-1 px-7 rounded-md text-white",onClick:()=>v(),children:"UnBlock"}):x?e.jsx("button",{className:"bg-primary py-1 px-7 rounded-md text-white",onClick:()=>R(),children:"Unfollow"}):e.jsx("button",{className:"bg-primary py-1 px-7 rounded-md text-white",onClick:()=>E(),children:"Follow"})}),e.jsx("h1",{className:"mt-8 mb-3",children:"Bio"}),e.jsx("span",{className:"bio",children:a==null?void 0:a.bio})]})]}),e.jsxs("section",{className:"posts-section col-span-9",children:[e.jsxs("header",{className:"w-full flex justify-between p-5 relative",children:[e.jsx("h1",{className:"p-5 text-lg font-medium",children:"Posts"}),e.jsx("div",{className:"",onClick:()=>f(!h),children:e.jsx(q,{size:35})}),h&&e.jsx(d,{className:"w-48 absolute right-5 top-16",onClick:()=>f(!h),children:e.jsxs("div",{className:"shadow-md",children:[g?e.jsx(d.Item,{onClick:()=>v(),children:"UnBlock"}):e.jsx(d.Item,{onClick:()=>U(),children:"Block"}),e.jsx(d.Item,{onClick:()=>j(!0),children:"Report"}),e.jsx(d.Item,{onClick:$,children:"Messages"})]})})]}),e.jsx("div",{className:"body",children:e.jsx(V,{style:{overflow:"hidden",height:"100%"},className:"image-list",variant:"masonry",cols:3,gap:1,children:N&&N.map(s=>e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"",children:e.jsx("div",{className:"content p-2 shadow-md",onClick:()=>O(s),children:s.type.includes("image")?e.jsx("img",{src:s==null?void 0:s.content,className:"w-full rounded-md"}):e.jsx("div",{className:"relative",children:e.jsxs("video",{className:"w-full",muted:!0,children:[e.jsx("source",{src:s==null?void 0:s.content,type:"video/mp4"}),"Error Message"]})})})},s._id),y&&e.jsx(H,{openModal:B,setOpenModal:w,type:"OTHERS",post:y})]}))})})]})]})]})}export{le as default};
