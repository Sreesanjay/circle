import{a as S,u as y,r as t,bf as k,j as e,bg as E,m as _,i as b,Q as N,aO as L,a_ as U,L as F,E as C,aP as O,bh as z,bi as R,bj as P,be as I}from"./index-smUx3BSe.js";import{P as T}from"./PopupModal--lX4-ok8.js";import{M as v,F as M,f as D}from"./Toast-nm33oYh4.js";import{I as A}from"./ImageCrop-b3nw7QQT.js";import{U as B}from"./ProfileUpload-biYNkUVD.js";import{u as $,S as V}from"./Skeleton-Y0V56SGc.js";import"./index.esm-MxRIW45I.js";import"./createBox-frviSQRh.js";import"./extendSxProp-btoSsoGR.js";function H({showUploadImage:a,setshowUploadImage:s}){const c=S(),{userProfile:l}=y(n=>n.user),[i,m]=t.useState(!1),[o,g]=t.useState(""),[d,u]=t.useState();t.useEffect(()=>{if(s(!1),d){const n=new File([d],"cover_img",{type:d.type});c(k(n))}},[d,c,s]);function p(){s(!1)}const h={width:"100%",height:"40px"},w={width:"100%",height:"40px",backgroundColor:"red"};function j(n){n.target.files&&(p(),g(URL.createObjectURL(n.target.files[0])),m(!0))}function r(){c(E()),p()}return e.jsxs(e.Fragment,{children:[e.jsx(A,{src:o,aspect:16/9,isCrop:i,setisCrop:m,setImage:u}),e.jsxs(v,{show:a,size:"md",onClose:p,popup:!0,children:[e.jsx(v.Header,{}),e.jsx(v.Body,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-medium text-gray-900 dark:text-white",children:"Upload Cover Image"}),e.jsx("div",{children:e.jsx("div",{className:"mb-2",children:e.jsx(M,{id:"small-file-upload",sizing:"sm",style:h,onChange:j})})}),(l==null?void 0:l.cover_img)&&e.jsx("div",{className:"w-full",children:e.jsx(D,{style:w,onClick:r,children:"Delete"})})]})})]})]})}function q(a,s=250){let c;return(...l)=>{clearTimeout(c),c=setTimeout(()=>{a(...l)},s)}}function G({openModal:a,setOpenModal:s,title:c}){const[l,i]=t.useState([]),m=_(),o=t.useRef(!1),[g,d]=t.useState(!1),u=t.useRef(0),p=$(()=>h("")),h=t.useCallback(async r=>{d(!0);const n=c==="Following"?`/users/following?search=${r}&page=${u.current}`:`/users/followers?search=${r}&page=${u.current}`;try{const x=await b.get(n,{withCredentials:!0});x.data&&(u.current=u.current+1,o.current?(o.current=!1,i(x.data.userList)):i(f=>[...f,...x.data.userList])),d(!1)}catch(x){const f=x;N.error(f.message),d(!1)}},[c]);async function w(r){d(!0);try{(await b.post("/users/unfollow",{id:r},{withCredentials:!0})).data&&i(x=>x.filter(f=>f.user_id!==r)),d(!1)}catch(n){const x=n;N.error(x.message),d(!1)}}t.useEffect(()=>{a&&(u.current=0,h(""))},[a,h]);const j=q(r=>{h(r)},500);return e.jsxs(v,{show:a,size:"md",onClose:()=>{i([]),s(!1)},children:[e.jsx(v.Header,{children:e.jsx("div",{className:"space-y-6 text-center",children:c})}),e.jsx("div",{className:"h-screen overflow-y-scroll userList",ref:p,children:e.jsxs(v.Body,{children:[e.jsx("input",{type:"text",className:"rounded-md w-full",onChange:r=>{o.current=!0,u.current=0,j(r.target.value)}}),e.jsx("div",{className:"users-list",children:l&&l.map((r,n)=>e.jsxs("div",{className:"user-card my-4 bg-gray-100 p-2 rounded-md flex items-center gap-3 justify-between",children:[e.jsxs("div",{className:"left flex gap-3",onClick:()=>m(`/view-profile/${r.user_id}`),children:[r.profile_img?e.jsx("img",{src:r.profile_img,alt:"",className:"w-10 rounded-md"}):e.jsx("h1",{className:"p-2 px-4 rounded-md bg-gray-400",children:r.email[0].toUpperCase()}),e.jsxs("div",{className:"name",children:[e.jsx("h1",{children:r.username}),e.jsx("p",{className:"text-sm text-gray-600",children:r.fullname})]})]}),c==="Following"&&e.jsx("button",{className:"bg-primary hover:bg-primary-hover px-2 py-1 rounded-md text-white",onClick:()=>w(r.user_id),children:"Unfollow"})]},n))}),g&&e.jsx(V,{})]})})]})}function Q(){const[a,s]=t.useState(),[c,l]=t.useState(""),[i,m]=t.useState(!1);return t.useEffect(()=>{(async()=>{try{const o=await b.get("/profile/connection-count",{withCredentials:!0});o.data&&s({followers:o.data.connectionCount.followers,following:o.data.connectionCount.following})}catch(o){N(o.message)}})()},[]),e.jsxs("div",{className:"friend-list flex w-full justify-around sm-pe-7",children:[e.jsx(G,{openModal:i,setOpenModal:m,title:c}),e.jsxs("div",{className:"wrapper flex flex-col items-center",onClick:()=>{l("Following"),m(!0)},children:[e.jsx("h1",{children:a==null?void 0:a.following}),e.jsx("h3",{children:"Following"})]}),e.jsxs("div",{className:"wrapper flex flex-col items-center",onClick:()=>{l("Followers"),m(!0)},children:[e.jsx("h1",{children:a==null?void 0:a.followers}),e.jsx("h3",{children:"Followers"})]})]})}function Y(){const a=_(),[s,c]=t.useState([]);return t.useEffect(()=>{(async()=>{try{const l=await b.get("/users/close-friends",{withCredentials:!0});l.data&&c(l.data.userList)}catch(l){const i=l;N.error(i.message)}})()},[]),e.jsxs("div",{className:"flex gap-3",children:[s.length===0&&e.jsxs("div",{className:"flex flex-col gap-5 text-sm",children:[e.jsx("h1",{children:"You dont have any close friends"}),e.jsx("button",{className:"bg-gray-700 py-2 rounded-md",onClick:()=>a("/manage-account/close-friends"),children:"Add Close friends"})]}),s&&s.map((l,i)=>e.jsx("div",{className:"",children:l.profile_img?e.jsx("img",{src:l.profile_img,alt:"",className:"w-10 rounded-md"}):e.jsx("h1",{className:"p-2 px-4 rounded-md bg-gray-400",children:l.email[0].toUpperCase()})},i))]})}function J(){const{user:a}=y(c=>c.auth),{userProfile:s}=y(c=>c.user);return e.jsx("div",{className:"md:grid md:grid-cols-6 h-full p-5",children:e.jsxs("div",{className:"profile-section col-span-4",children:[e.jsx("h1",{className:"font-medium text-lg mb-5",children:"View Profile"}),e.jsxs("div",{className:"wrapper grid grid-cols-4 mb-4",children:[e.jsx("h1",{className:"key font-medium col-span-4 sm:col-span-1",children:"Full Name"}),e.jsx("h1",{className:"value sm:col-span-3",children:s==null?void 0:s.fullname})]}),e.jsxs("div",{className:"wrapper grid grid-cols-4 mb-4",children:[e.jsx("h1",{className:"key font-medium col-span-4 sm:col-span-1",children:"Email"}),e.jsx("h1",{className:"value sm:col-span-3 text-sm",children:a==null?void 0:a.email})]}),e.jsxs("div",{className:"wrapper grid grid-cols-4 mb-4",children:[e.jsx("h1",{className:"key font-medium col-span-4 sm:col-span-1",children:"Username"}),e.jsx("h1",{className:"value sm:col-span-3 text-sm",children:s==null?void 0:s.username})]}),e.jsxs("div",{className:"wrapper grid grid-cols-4 mb-4",children:[e.jsx("h1",{className:"key font-medium col-span-4 sm:col-span-1",children:"Gender"}),e.jsx("h1",{className:"value sm:col-span-3 text-sm",children:s==null?void 0:s.gender})]}),e.jsxs("div",{className:"wrapper mb-4",children:[e.jsx("h1",{className:"key font-medium mb-2",children:"Bio"}),e.jsx("h1",{className:"value text-sm",children:s==null?void 0:s.bio})]})]})})}const W=t.lazy(()=>I(()=>import("./PostSection-0sgozynH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),X=t.lazy(()=>I(()=>import("./SavedSection-yvNspL5Q.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])));function ne(){const a=S(),{userProfile:s,isLoading:c,isError:l,isSuccess:i,errorMessage:m}=y(f=>f.user),[o,g]=t.useState(!1),[d,u]=t.useState(!1),[p,h]=t.useState(!1),[w,j]=t.useState("hidden"),[r,n]=t.useState("PROFILE");t.useEffect(()=>{l?N(m):i&&(s||g(!0)),a(L())},[l,m,i,s,a]),t.useEffect(()=>{a(U())},[a]);function x(){N.success("profile updated")}return e.jsxs(e.Fragment,{children:[e.jsx(H,{showUploadImage:d,setshowUploadImage:u}),e.jsx(B,{showUploadProfile:p,setshowUploadProfile:h}),e.jsx(T,{modalState:o,message:"Profile updation pending. update now?",posText:"Update Now",negText:"Later",successCallback:x,cancelCallback:null}),c?e.jsx(F,{}):e.jsxs("section",{className:"user-profile flex flex-col items-center sm:items-start",children:[e.jsxs("section",{className:"cover-photo",children:[e.jsx("button",{onClick:()=>u(!0),className:"add-cover-btn p-2 shadow-lg",children:e.jsx(C,{size:25})}),s!=null&&s.cover_img?e.jsx("img",{src:s==null?void 0:s.cover_img,className:"object-cover"}):e.jsx("div",{className:"default-cover",children:e.jsx("img",{src:"https://images.fastcompany.net/image/upload/w_596,c_limit,q_auto:best,f_auto/wp-cms/uploads/2021/03/LinkedIn-Default-Background-2020-.jpg",alt:""})})]}),e.jsxs("section",{className:"header bg-gray-900 flex flex-col items-center sm:flex-row sm:items-end w-full pb-1 shadow-2xl",children:[e.jsxs("div",{className:"left-area sm:ms-20 pb-2",children:[e.jsxs("div",{className:"profile-img relative",onMouseOverCapture:()=>j("block"),onMouseOutCapture:()=>j("hidden"),children:[e.jsx("button",{className:`edit-profileImg w-full h-full absolute top-0 ${w}`,onClick:()=>h(!0),children:e.jsx(C,{size:30})}),s!=null&&s.profile_img?e.jsx("img",{src:s==null?void 0:s.profile_img,alt:"",className:"w-full shadow-lg rounded-md"}):e.jsx("img",{src:"https://static.vecteezy.com/system/resources/thumbnails/010/260/479/small/default-avatar-profile-icon-of-social-media-user-in-clipart-style-vector.jpg",alt:"",className:"w-full shadow-lg rounded-md"})]}),e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("h1",{className:"text-center mt-3 text-xl font-medium",children:s==null?void 0:s.username}),(s==null?void 0:s.isVerified)&&e.jsx("p",{className:"text-blue-600 text-xl",children:e.jsx(O,{})})]})]}),e.jsxs("div",{className:"right-nav grow ps-7 sm:ps-14 flex",children:[e.jsxs("div",{className:"flex flex-col items-center hover:bg-gray-700 rounded-md p-2 mt-2 sm:me-9",onClick:()=>n("PROFILE"),children:[e.jsx(z,{size:28}),e.jsx("h3",{className:"",children:"Profile"})]}),e.jsxs("div",{className:"flex flex-col items-center hover:bg-gray-700 rounded-md p-2 mt-2 sm:me-9",onClick:()=>n("POST"),children:[e.jsx(R,{size:28}),e.jsx("h3",{className:"",children:"Posts"})]}),e.jsxs("div",{className:"flex flex-col items-center hover:bg-gray-700 rounded-md p-2 mt-2 sm:me-9",onClick:()=>n("SAVED"),children:[e.jsx(P,{size:28}),e.jsx("h3",{className:"",children:"Saved"})]})]})]}),e.jsxs("section",{className:"profile-body min-h-screen w-full md:grid md:grid-cols-12",children:[e.jsxs("div",{className:"left-section col-span-3 px-5 bg-gray-800 shadow-xl py-5",children:[e.jsx(Q,{}),e.jsx("hr",{className:"my-3"}),e.jsx("div",{className:"flex items-center mb-3 justify-between",children:e.jsx("h1",{className:"font-medium text-center",children:"Close Friends"})}),e.jsx(Y,{})]}),e.jsxs("div",{className:"right-section col-span-9 pt-5 px-3",children:[r==="PROFILE"&&e.jsx(J,{}),r==="POST"&&e.jsx(W,{}),r==="SAVED"&&e.jsx(X,{})]})]})]})]})}export{ne as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/PostSection-0sgozynH.js","assets/index-smUx3BSe.js","assets/index-BK0PMdq-.css","assets/PostModal-o5EqILRD.js","assets/Toast-nm33oYh4.js","assets/index.esm-MxRIW45I.js","assets/index.esm-5Np7Lkjm.js","assets/usehandleError-IFaWY-0c.js","assets/Badge-C1CXGjQP.js","assets/Typography-t2B5OcaA.js","assets/extendSxProp-btoSsoGR.js","assets/PostModal-qOpLdxIh.css","assets/Skeleton-Y0V56SGc.js","assets/createBox-frviSQRh.js","assets/Skeleton-KofQWI2B.css","assets/ImageListItem-IXoXwTWK.js","assets/SavedSection-yvNspL5Q.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
