import{u as f,m as v,a as y,r as a,i as D,Q as S,v as C,j as e,L as k,w as R,x as I,y as M,z as O,B as T,F as U,G as F}from"./index-m-eWRAVj.js";import{d as Y}from"./Menu-ML_fOrjv.js";import{M as N}from"./Toast-KVdhVArs.js";import{D as P}from"./DiscussionCard-AUVZG6p6.js";import"./index.esm-5AkatTaU.js";import"./Report-vUX28oJA.js";function $({showModal:s,setShowModal:i}){const{isLoading:l,isSuccess:c,isError:t,errorMessage:n}=f(x=>x.community),m=v(),o=y(),[d,u]=a.useState(""),[p,g]=a.useState([]),[r,w]=a.useState({community_name:"",topic:null,privacy:"public",about:""});a.useEffect(()=>{(async()=>{var x;try{const h=await D.get("/manage-account/interest");h.data&&g(h.data.interest)}catch(h){const b=h;S.error((x=b.response)==null?void 0:x.data.message)}})()},[]);function j(x){const{name:h,value:b}=x.target;w({...r,[h]:b})}a.useEffect(()=>{t&&S.error(n),c&&i(!1),(t||c)&&o(C())},[t,c,o,n,m,i]);function E(){r.community_name&&r.topic?(u(""),o(R(r))):r.community_name?r.topic||u("Please select a topic"):u("Please select a name")}return e.jsx(e.Fragment,{children:l?e.jsx(k,{}):e.jsxs(N,{show:s,size:"2xl",onClose:()=>{u(""),i(!1)},popup:!0,children:[e.jsx(N.Header,{children:e.jsx("div",{className:"p-4",children:"New Community"})}),e.jsxs(N.Body,{children:[d&&e.jsx("small",{className:"text-sm text-red-600",children:d}),e.jsxs("div",{className:"input-group flex flex-col",children:[e.jsx("label",{htmlFor:"",className:"font-medium",children:"Community Name"}),e.jsx("input",{type:"text",name:"community_name",id:"",className:"rounded-md",onChange:j})]}),e.jsxs("div",{className:"flex gap-3 w-full justify-between",children:[e.jsxs("div",{className:"input-group flex flex-col mt-5 w-full",children:[e.jsx("label",{htmlFor:"",className:"font-medium",children:"Choose a Topic"}),e.jsxs("select",{name:"topic",id:"",className:"rounded-md",onChange:j,children:[e.jsx("option",{value:""}),p.map((x,h)=>e.jsx("option",{value:x._id,children:x.interest},h))]})]}),e.jsxs("div",{className:"input-group flex flex-col mt-5 mb-5 w-full",children:[e.jsx("label",{htmlFor:"",className:"font-medium",children:"Privacy"}),e.jsxs("select",{name:"privacy",id:"",className:"rounded-md",onChange:j,children:[e.jsx("option",{value:"public",children:"Public"}),e.jsx("option",{value:"private",children:"Private"})]})]})]}),e.jsxs("div",{className:"input-group flex flex-col mt-5",children:[e.jsx("label",{htmlFor:"",className:"font-medium",children:"About"}),e.jsx("textarea",{name:"about",id:"",className:"rounded-md"})]}),e.jsxs("div",{className:"btn py-5",children:[e.jsx("button",{className:"btn px-5 py-1 bg-red-700 hover:bg-red-500 rounded-md text-white",onClick:()=>{w({community_name:"",topic:null,privacy:"public",about:""})},children:"Clear"}),e.jsx("button",{className:"btn px-5 py-1 bg-primary hover:bg-primary-hover ms-3 rounded-md text-white",onClick:E,children:"Create"})]})]})]})})}function _({community:s,type:i}){var u;const l=v(),c=y(),{user:t}=f(p=>p.auth),[n,m]=a.useState([]),[o,d]=a.useState([]);return a.useEffect(()=>{var p,g;s!=null&&s.members.length&&(m((p=s==null?void 0:s.members)==null?void 0:p.filter(r=>r.status==="active").map(r=>r.user_id)),d((g=s==null?void 0:s.members)==null?void 0:g.filter(r=>r.status==="pending").map(r=>r.user_id)))},[s.members]),e.jsxs("div",{className:"community-card  rounded-md w-72 h-min bg-gray-900 shadow-lg",children:[e.jsx("div",{className:"icon  w-full h-min",children:s.icon?e.jsx("img",{src:s.icon,alt:"",className:"w-full h-28 object-cover"}):e.jsx("div",{className:"icon-with-text h-full flex items-center justify-center bg-gray-700",children:e.jsx("h1",{className:"text-6xl w-full h-28 rounded-full  text-center flex justify-center items-center",children:typeof(s==null?void 0:s.community_name)=="string"&&((u=s.community_name[0])==null?void 0:u.toUpperCase())})})}),e.jsxs("div",{className:"body bg-gray-900 py-3 px-2 h-44 flex flex-col justify-between",children:[e.jsx("h1",{className:"title text-wrap text-lg font-medium text-center",children:s.community_name}),e.jsx("div",{className:"stat",children:e.jsxs("h1",{className:"text-center text-sm text-slate-400",children:[n==null?void 0:n.length," Members"]})}),i==="my_community"||n.includes(t==null?void 0:t._id)?e.jsx("button",{className:"view-community w-full py-2 rounded-md bg-primary hover:bg-primary",onClick:()=>l(`/community/view/${s._id}`),children:"View"}):o.includes(t==null?void 0:t._id)?e.jsx("button",{className:"view-community w-full py-2 rounded-md bg-primary",children:"Pending"}):e.jsx("button",{className:"view-community w-full py-2 rounded-md bg-primary hover:bg-primary",onClick:()=>c(I(s._id)),children:"Join"})]})]})}function A(){const s=y(),{myCommunity:i,isSuccess:l,isError:c}=f(t=>t.community);return a.useEffect(()=>{s(M())},[s]),a.useEffect(()=>{s(C())},[l,c,s]),e.jsx("section",{className:"your-community flex p-5 flex-wrap justify-center sm:justify-start gap-10 bg-gray-800 min-h-full",children:i.length===0?e.jsxs("div",{className:"w-full flex justify-center items-center flex-col",children:[e.jsx("img",{src:"https://png.pngtree.com/svg/20161030/nodata_800056.png",className:"w-40",alt:""}),e.jsx("h1",{className:"text-gray-400",children:"No Communities Found"})]}):i.map((t,n)=>e.jsx(_,{community:t,type:"my_community"},n))})}function L(){const s=y(),{community:i,isSuccess:l,isError:c}=f(n=>n.community),{user:t}=f(n=>n.auth);return a.useEffect(()=>{s(O())},[s]),a.useEffect(()=>{s(C())},[l,c,s]),e.jsx("section",{className:"your-community flex sm:p-5 flex-wrap gap-5 justify-evenly sm:justify-start bg-gray-800 min-h-full",children:i.length===0?e.jsxs("div",{className:"w-full flex justify-center items-center flex-col",children:[e.jsx("img",{src:"https://png.pngtree.com/svg/20161030/nodata_800056.png",className:"w-40",alt:""}),e.jsx("h1",{className:"text-gray-400",children:"No Communities Found"})]}):i.map((n,m)=>{if(!n.members.filter(d=>d.status==="active").map(d=>d.user_id).includes(t==null?void 0:t._id))return e.jsx(_,{community:n,type:"discover"},m)})})}function V(){const[s,i]=a.useState([]),l=a.useRef(null);a.useEffect(()=>{c()},[]);async function c(){let t=null;t=s.length>0?s[s.length-1].createdAt:null;const n=await T(t);n.discussions&&i(t===null?n.discussions:[...s,...n.discussions])}return a.useEffect(()=>{const t=()=>{const{current:m}=l;if(m){const{scrollTop:o,scrollHeight:d,clientHeight:u}=m;o+u>=d-1&&c()}},n=l.current;return n&&n.addEventListener("scroll",t),()=>{n&&n.removeEventListener("scroll",t)}},[s]),e.jsx("div",{className:" p-5 sm:p-10 bg-gray-800 h-full overflow-y-scroll",ref:l,children:s.length===0?e.jsxs("div",{className:"w-full h-1/2 flex justify-center items-center flex-col",children:[e.jsx("img",{src:"https://png.pngtree.com/svg/20161030/nodata_800056.png",className:"w-40",alt:""}),e.jsx("h1",{className:"text-gray-400",children:"No Discussions Yet"})]}):s.map((t,n)=>e.jsx(P,{discussion:t,setDiscussion:i,type:"RECENT"},n))})}function q(){const{tab:s}=U(),i=v(),[l,c]=a.useState("hidden"),[t,n]=a.useState(s.toUpperCase()),[m,o]=a.useState(!1);return e.jsxs("div",{className:"grid grid-cols-12 overflow-y-hidden",children:[e.jsx($,{showModal:m,setShowModal:o}),e.jsxs("div",{className:"flex gap-2 col-span-12",children:[e.jsx("button",{className:"p-2 sm:hidden  flex rounded-sm mb-3",onClick:()=>c(l==="block"?"hidden":"block"),children:e.jsx(Y,{})}),e.jsx("h1",{className:`${l==="block"?"hidden":"block"} sm:hidden text-xl mt-2`,children:"Community"})]}),e.jsxs("section",{className:`sidebar col-span-12 sm:col-span-3 bg-gray-900 flex flex-col p-5 py-8 ${l} sm:block`,children:[e.jsx("h1",{className:"text-2xl mb-10",children:"Community"}),e.jsxs("div",{className:"nav flex flex-col gap-3",onClick:()=>c(l==="block"?"hidden":"block"),children:[e.jsx("div",{className:`item hover:bg-gray-800 ${t==="RECENT_DISCUSSIONS"&&"bg-gray-800"}  rounded-md p-5 py-3`,onClick:()=>{n("RECENT_DISCUSSIONS"),i("/community/recent_discussions")},children:e.jsx("h2",{className:"text-lg",children:"Recent Discussions"})}),e.jsx("div",{className:`item hover:bg-gray-800 ${t==="DISCOVER"&&"bg-gray-800"}  rounded-md p-5 py-3`,onClick:()=>{n("DISCOVER"),i("/community/discover")},children:e.jsx("h2",{className:"text-lg",children:"Discover"})}),e.jsx("div",{className:`item hover:bg-gray-800 ${t==="YOUR_COMMUNITY"&&"bg-gray-800"}  rounded-md p-5 py-3`,onClick:()=>{n("YOUR_COMMUNITY"),i("/community/your_community")},children:e.jsx("h2",{className:"text-lg",children:"Your Community"})})]}),e.jsx("div",{className:"new-community mt-7 px-5 py-3 bg-gray-800 hover:bg-gray-600 cursor-pointer rounded-md",children:e.jsxs("button",{className:"text-lg flex gap-3",onClick:()=>o(!0),children:[e.jsx("div",{className:"text-primary",children:e.jsx(F,{})}),"Community"]})})]}),e.jsx("section",{className:"page-body col-span-12 sm:col-span-9 bg-blue-700 overflow-y-scroll",children:t==="RECENT_DISCUSSIONS"?e.jsx(V,{}):t==="DISCOVER"?e.jsx(L,{}):t==="YOUR_COMMUNITY"?e.jsx(A,{}):null})]})}export{q as default};
