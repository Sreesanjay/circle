import{i as x,Q as c,r as o,j as e}from"./index-m-eWRAVj.js";import{A as _}from"./AdminSidebar-aX9fpIq8.js";import{B as y,T as t,P as b}from"./Toast-KVdhVArs.js";import{F as R,N as T,V as E}from"./ViewReports-oN5U2HAR.js";import"./Menu-ML_fOrjv.js";import"./index.esm-XQb_oNS5.js";import"./index.esm-5AkatTaU.js";async function S(){var r;try{return(await x.get("/admin/chat-management/analytics")).data}catch(n){const a=n;a.response?c.error((r=a.response)==null?void 0:r.data.message):c.error(a.message)}}async function A(r,n){var a;try{return(await x.get(`/admin/chat-management?page=${r}&&sort=${n}`)).data}catch(l){const i=l;i.response?c.error((a=i.response)==null?void 0:a.data.message):c.error(i.message)}}async function D(r){var n;try{return(await x.delete(`/admin/chat-management/remove/${r}`)).data}catch(a){const l=a;l.response?c.error((n=l.response)==null?void 0:n.data.message):c.error(l.message)}}async function P(r){var n;try{return(await x.put(`/admin/chat-management/undo-remove/${r}`)).data}catch(a){const l=a;l.response?c.error((n=l.response)==null?void 0:n.data.message):c.error(l.message)}}function $(){const[r,n]=o.useState({total_chat:0,todays_chat:0,thismonth_chat:0,this_year_chat:0}),[a,l]=o.useState("RECENTLTY_CREATED"),[i,g]=o.useState(1),[p,u]=o.useState([]),[f,C]=o.useState(null),[N,j]=o.useState(!1);o.useEffect(()=>{(async()=>{const s=await S();s.analytics&&n(s.analytics)})()},[]),o.useEffect(()=>{(async()=>{const s=await A(i,a);s.groups&&u(s.groups)})()},[i,a]);async function w(s){(await D(s)).chat&&u(h=>h.map(d=>(d._id===s&&(d.is_delete=!0),d)))}async function v(s){(await P(s)).chat&&(c.success("chat recovered"),u(h=>h.map(d=>(d._id===s&&(d.is_delete=!1),d))))}return e.jsxs("div",{children:[e.jsxs("div",{className:"community-management",children:[e.jsx(_,{}),e.jsxs("section",{className:"body md:ms-80 py-5",children:[e.jsx(y,{"aria-label":"Default breadcrumb example",children:e.jsx(y.Item,{href:"#",children:"Post Management"})}),e.jsxs("section",{className:"analytics flex justify-around gap-2 flex-wrap mt-5",children:[e.jsxs("div",{className:"analytics-card ",children:[e.jsx("h1",{children:"Total Communities"}),e.jsx("h1",{className:"text-4xl",children:r.total_chat})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community(Today)"}),e.jsx("h1",{className:"text-4xl",children:r.todays_chat})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community(This Month)"}),e.jsx("h1",{className:"text-4xl",children:r.thismonth_chat})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community (This Year)"}),e.jsx("h1",{className:"text-4xl",children:r.this_year_chat})]})]}),e.jsxs("section",{className:"filter flex items-center justify-between my-5 px-5",children:[e.jsx("div",{className:"sort",children:e.jsxs(R,{fullWidth:!0,children:[e.jsx("label",{htmlFor:"uncontrolled-native",children:"Sort"}),e.jsxs(T,{defaultValue:a,inputProps:{name:"sort",id:"uncontrolled-native"},onChange:s=>l(s.target.value),children:[e.jsx("option",{value:"RECENTLTY_CREATED",children:"Recently Created"}),e.jsx("option",{value:"OLDEST_CHAT",children:"Oldest Chats"}),e.jsx("option",{value:"REPORTS",children:"Reports"})]})]})}),e.jsx("div",{className:"search",children:e.jsx("input",{type:"text",placeholder:"Search Communities",className:"rounded-md text-black"})})]}),e.jsxs("section",{className:"community-list py-5 pe-5 overflow-x-scroll",children:[e.jsxs(t,{hoverable:!0,children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Si. No"}),e.jsx(t.HeadCell,{children:"Chat Name"}),e.jsx(t.HeadCell,{children:"Total Members"}),e.jsx(t.HeadCell,{children:"Created On"}),e.jsx(t.HeadCell,{children:"View"}),e.jsx(t.HeadCell,{children:"Reports"}),e.jsx(t.HeadCell,{children:e.jsx("span",{className:"sr-only",children:"Delete"})})]}),e.jsx(t.Body,{className:"divide-y",children:p==null?void 0:p.map((s,m)=>{var h;return e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"whitespace-nowrap font-medium text-gray-900 dark:text-white",children:m}),e.jsx(t.Cell,{children:s.is_groupchat?s.chat_name:"Personal chat"}),e.jsx(t.Cell,{children:s.members.length}),e.jsxs(t.Cell,{children:[new Date(s.createdAt).getDay()," ","/"," ",new Date(s.createdAt).getMonth(),"/",new Date(s.createdAt).getFullYear()]}),e.jsx(t.Cell,{children:e.jsx("button",{onClick:()=>{C(s._id),j(!0)},children:"View"})}),e.jsx(t.Cell,{children:(h=s.reports)==null?void 0:h.length}),e.jsx(t.Cell,{children:s.is_delete?e.jsx("button",{onClick:()=>v(s._id),children:"Undo"}):e.jsx("button",{onClick:()=>w(s._id),className:"text-red-600",children:"Delete"})})]},m)})})]}),e.jsx("div",{className:"pagination mt-5",children:e.jsx(b,{currentPage:i,totalPages:Math.ceil(r.total_chat/10),onPageChange:s=>g(s)})})]})]})]}),e.jsx(E,{reportedId:f,openModal:N,setOpenModal:j})]})}export{$ as default};
