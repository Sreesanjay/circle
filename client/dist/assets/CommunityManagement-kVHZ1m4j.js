import{i as h,Q as o,r as l,j as e}from"./index-m-eWRAVj.js";import{A as w}from"./AdminSidebar-aX9fpIq8.js";import{B as j,T as t,P as b}from"./Toast-KVdhVArs.js";import{F as R,N as T,V as E}from"./ViewReports-oN5U2HAR.js";import"./Menu-ML_fOrjv.js";import"./index.esm-XQb_oNS5.js";import"./index.esm-5AkatTaU.js";async function S(){var n;try{return(await h.get("/admin/community-management/analytics")).data}catch(r){const a=r;a.response?o.error((n=a.response)==null?void 0:n.data.message):o.error(a.message)}}async function P(n,r){var a;try{return(await h.get(`/admin/community-management?page=${n}&&sort=${r}`)).data}catch(i){const c=i;c.response?o.error((a=c.response)==null?void 0:a.data.message):o.error(c.message)}}async function k(n){var r;try{return(await h.put(`/admin/community-management/remove/${n}`)).data}catch(a){const i=a;i.response?o.error((r=i.response)==null?void 0:r.data.message):o.error(i.message)}}async function H(n){var r;try{return(await h.put(`/admin/community-management/undo-remove/${n}`)).data}catch(a){const i=a;i.response?o.error((r=i.response)==null?void 0:r.data.message):o.error(i.message)}}function V(){const[n,r]=l.useState({total_community:0,todays_community:0,thismonth_community:0,this_year_community:0}),[a,i]=l.useState("RECENTLTY_CREATED"),[c,f]=l.useState(1),[x,p]=l.useState([]),[g,C]=l.useState(null),[N,y]=l.useState(!1);l.useEffect(()=>{(async()=>{const s=await S();s.analytics&&r(s.analytics)})()},[]),l.useEffect(()=>{(async()=>{const s=await P(c,a);s.communityList&&p(s.communityList)})()},[c,a]);async function v(s){(await k(s)).community&&(o.success("community removed"),p(d=>d.map(m=>(m._id===s&&(m.is_delete=!0),m))))}async function _(s){(await H(s)).community&&(o.success("community recovered"),p(d=>d.map(m=>(m._id===s&&(m.is_delete=!1),m))))}return e.jsxs("div",{children:[e.jsxs("div",{className:"community-management",children:[e.jsx(w,{}),e.jsxs("section",{className:"body md:ms-80 py-5",children:[e.jsx(j,{"aria-label":"Default breadcrumb example",children:e.jsx(j.Item,{href:"#",children:"Post Management"})}),e.jsxs("section",{className:"analytics flex justify-around gap-2 flex-wrap mt-5",children:[e.jsxs("div",{className:"analytics-card ",children:[e.jsx("h1",{children:"Total Communities"}),e.jsx("h1",{className:"text-4xl",children:n.total_community})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community(Today)"}),e.jsx("h1",{className:"text-4xl",children:n.todays_community})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community(This Month)"}),e.jsx("h1",{className:"text-4xl",children:n.thismonth_community})]}),e.jsxs("div",{className:"analytics-card",children:[e.jsx("h1",{children:"New community (This Year)"}),e.jsx("h1",{className:"text-4xl",children:n.this_year_community})]})]}),e.jsxs("section",{className:"filter flex items-center justify-between my-5 px-5",children:[e.jsx("div",{className:"sort",children:e.jsxs(R,{fullWidth:!0,children:[e.jsx("label",{htmlFor:"uncontrolled-native",children:"Sort"}),e.jsxs(T,{defaultValue:a,inputProps:{name:"sort",id:"uncontrolled-native"},onChange:s=>i(s.target.value),children:[e.jsx("option",{value:"RECENTLTY_CREATED",children:"Recently Created"}),e.jsx("option",{value:"OLDEST_COMMUNITY",children:"Oldest Posts"}),e.jsx("option",{value:"REPORTS",children:"Reports"})]})]})}),e.jsx("div",{className:"search",children:e.jsx("input",{type:"text",placeholder:"Search Communities",className:"rounded-md text-black"})})]}),e.jsxs("section",{className:"community-list py-5 pe-5 overflow-x-scroll",children:[e.jsxs(t,{hoverable:!0,children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Si. No"}),e.jsx(t.HeadCell,{children:"Community name"}),e.jsx(t.HeadCell,{children:"Privacy"}),e.jsx(t.HeadCell,{children:"Total members"}),e.jsx(t.HeadCell,{}),e.jsx(t.HeadCell,{children:"Reports"}),e.jsx(t.HeadCell,{children:e.jsx("span",{className:"sr-only",children:"Block"})})]}),e.jsx(t.Body,{className:"divide-y",children:x==null?void 0:x.map((s,u)=>{var d;return e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"whitespace-nowrap font-medium text-gray-900 dark:text-white",children:u}),e.jsx(t.Cell,{children:s.community_name}),e.jsx(t.Cell,{children:s.privacy}),e.jsx(t.Cell,{children:s.members.length}),e.jsx(t.Cell,{children:e.jsx("button",{onClick:()=>{C(s._id),y(!0)},children:"View"})}),e.jsx(t.Cell,{children:(d=s.reports)==null?void 0:d.length}),e.jsx(t.Cell,{children:s.is_delete?e.jsx("button",{onClick:()=>_(s._id),children:"Undo"}):e.jsx("button",{onClick:()=>v(s._id),className:"text-red-600",children:"Delete"})})]},u)})})]}),e.jsx("div",{className:"pagination mt-5",children:e.jsx(b,{currentPage:c,totalPages:Math.ceil(n.total_community/10),onPageChange:s=>f(s)})})]})]})]}),e.jsx(E,{reportedId:g,openModal:N,setOpenModal:y})]})}export{V as default};
